/*!
 * sora-js-sdk
 * WebRTC SFU Sora Signaling Library
 * @version 0.3.2
 * @author Shiguredo Inc.
 * @license MIT
 */
!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Sora=n()}}(function(){return function n(e,o,t){function r(u,s){if(!o[u]){if(!e[u]){var c="function"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var a=o[u]={exports:{}};e[u][0].call(a.exports,function(n){var o=e[u][1][n];return r(o?o:n)},a,a.exports,n,e,o,t)}return o[u].exports}for(var i="function"==typeof require&&require,u=0;u<t.length;u++)r(t[u]);return r}({1:[function(n,e,o){"use strict";function t(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function n(n,e){for(var o=0;o<e.length;o++){var t=e[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}}(),i=function(){function n(e){t(this,n),this.url=e||""}return r(n,[{key:"connection",value:function(){return new s(this.url)}}]),n}(),u=["VP8","VP9","H264"],s=function(){function n(e){t(this,n),this._ws=null,this._url=e,this._onerror=function(){},this._onclose=function(){}}return r(n,[{key:"connect",value:function(n){var e=this;return new Promise(function(o,t){null===e._ws&&(e._ws=new WebSocket(e._url)),e._ws.onopen=function(){var o={type:"connect",role:n.role,channelId:n.channelId,accessToken:n.accessToken},t=u.indexOf(n.codecType);t>=0&&(o.video={codecType:u[t]}),e._ws.send(JSON.stringify(o))},e._ws.onclose=function(n){/440\d$/.test(n.code)?t(n):e._onclose(n)},e._ws.onerror=function(n){e._onerror(n)},e._ws.onmessage=function(n){var t=JSON.parse(n.data);"offer"==t.type?o(t):"ping"==t.type&&e._ws.send(JSON.stringify({type:"pong"}))}})}},{key:"answer",value:function(n){this._ws.send(JSON.stringify({type:"answer",sdp:n}))}},{key:"candidate",value:function(n){var e=n.toJSON();e.type="candidate",this._ws.send(JSON.stringify(e))}},{key:"onError",value:function(n){this._onerror=n}},{key:"onDisconnect",value:function(n){this._onclose=n}},{key:"disconnect",value:function(){this._ws.close(),this._ws=null}}]),n}();e.exports=i},{}]},{},[1])(1)});